<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aviator Prediction Simulator (One-Click Learning)</title>
    <style>
        /* CSS INAANZA HAPA */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212;
            color: #e0e0e0;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .container {
            background-color: #1e1e1e;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 450px;
        }
        h1 {
            color: #00e676;
            text-align: center;
            margin-bottom: 25px;
        }
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #bdbdbd;
        }
        input[type="number"] {
            width: calc(100% - 22px);
            padding: 10px;
            margin-bottom: 20px;
            border-radius: 6px;
            border: 1px solid #333;
            background-color: #2c2c2c;
            color: #fff;
            font-size: 16px;
        }
        button {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 6px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        #mainButton {
            background-color: #5e35b1; /* Purple for clarity */
            color: white;
            margin-bottom: 15px;
        }
        #mainButton:hover {
            background-color: #7e57c2;
        }
        
        /* Styling kwa ajili ya Voice Input Button */
        #micBtn {
            width: auto; 
            padding: 10px 15px; 
            background-color: #2196F3;
            color: white;
            transition: background-color 0.2s;
            margin-bottom: 20px;
        }
        #micBtn:hover {
            background-color: #64b5f6;
        }
        .result-box {
            margin-top: 25px;
            padding: 15px;
            border-radius: 8px;
            background-color: #2c2c2c;
            border-left: 5px solid #00e676;
        }
        .prediction {
            font-size: 24px;
            font-weight: bold;
            color: #ff9800;
            margin: 10px 0;
            text-align: center;
        }
        .jackpot {
            font-size: 18px;
            color: #e57373;
            text-align: center;
            margin-bottom: 10px;
        }
        .learning-status {
            font-size: 14px;
            color: #bdbdbd;
            margin-top: 15px;
            text-align: center;
            border-top: 1px dashed #444;
            padding-top: 10px;
        }
        .disclaimer {
            font-size: 12px;
            color: #9e9e9e;
            margin-top: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸš€ Aviator Prediction Simulator</h1>

        <label for="roundInput" id="roundLabel">Weka Matokeo ya Mzunguko Uliopita (Multiplier):</label>
        
        <div style="display: flex; align-items: center;">
            <input type="number" id="roundInput" step="0.01" placeholder="Mfano: 1.50 au 8.23" style="margin-right: 10px; margin-bottom: 0;">
            <button id="micBtn" style="width: auto; padding: 10px 15px;">ðŸŽ¤</button>
        </div>
        
        <button id="mainButton">Tabiri & Jifunze (One-Click)</button>
        

        <div id="results" class="result-box">
            <div class="jackpot" id="jackpotStatus"></div>
            <div class="prediction" id="predictionResult">Bonyeza kitufe kuanza.</div>
            <div class="learning-status" id="learningStatus"></div>
        </div>

        <p class="disclaimer">
            Kanusho: Hii ni code ya One-Click. Kujifunza sasa kunategemea kuigizwa (Simulation) kwa sababu data halisi haijaingizwa.
        </p>

    </div>

    <script>
        // Vigezo vya Mfumo wa Kujifunza (Learning Mechanism)
        let attempts = parseInt(localStorage.getItem('aviator_attempts') || 0);
        let mistakes = parseInt(localStorage.getItem('aviator_mistakes') || 0);
        
        const predictionResultEl = document.getElementById('predictionResult');
        const jackpotStatusEl = document.getElementById('jackpotStatus');
        const learningStatusEl = document.getElementById('learningStatus');
        const roundInput = document.getElementById('roundInput'); 
        const mainButton = document.getElementById('mainButton'); 
        const micBtn = document.getElementById('micBtn');

        // Onyesha hali ya kujifunza mwanzoni
        function updateLearningStatus() {
            learningStatusEl.textContent = 
                `Majukumu ya Utabiri: ${attempts} | Makosa (Simulated): ${mistakes} | Makosa yanaathiri utabiri ujao.`;
        }

        // Kazi ya Kutabiri Multiplier (Simple Heuristic Logic)
        function predictMultiplier(last) {
            const errorFactor = 1 + (mistakes / 50); 

            if (last < 1.3) {
                return (Math.random() * 2 * errorFactor + 1.2).toFixed(2); 
            } else if (last >= 1.3 && last < 3.0) {
                return (Math.random() * 1.5 * errorFactor + 1.0).toFixed(2);
            } else {
                return (Math.random() * 0.5 * errorFactor + 1.0).toFixed(2); 
            }
        }

        // Kazi ya Kuzalisha Matokeo ya Kuigiza (SIMULATED ACTUAL RESULT)
        function generateSimulatedActual(prediction) {
            // Tengeneza tofauti ndogo ya kubahatisha kutoka kwenye utabiri (+/- 1.5x)
            const randomOffset = (Math.random() * 3.0) - 1.5; 
            let simulatedActual = parseFloat(prediction) + randomOffset;
            
            // Hakikisha haishuki chini ya 1.0
            if (simulatedActual < 1.0) simulatedActual = 1.0; 
            return simulatedActual.toFixed(2);
        }

        // Kazi ya Kutabiri Jackpot (Random Chance)
        function checkJackpot() {
            const chance = Math.random();
            if (chance > 0.98) {
                return "ðŸš¨ JACKPOT TAHARUKI! (Jihadharini - fursa ndogo sana)";
            } else if (chance > 0.85) {
                return "ðŸ’¡ Utabiri: Fursa ya Juu ya Jackpot";
            } else {
                return "ðŸ’¤ Fursa ya Kawaida ya Jackpot";
            }
        }

        // --- SPEECH RECOGNITION LOGIC ---
        const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

        if (SpeechRecognition) {
            const recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.lang = 'en-US'; 

            micBtn.addEventListener('click', () => {
                micBtn.style.backgroundColor = '#FF0000';
                micBtn.textContent = 'ðŸ”´ TALK';
                recognition.start();
            });

            recognition.onresult = (event) => {
                const result = event.results[0][0].transcript;
                const numberMatch = result.match(/(\d+\.?\d*)/); 

                if (numberMatch) {
                    roundInput.value = parseFloat(numberMatch[0]).toFixed(2);
                    predictionResultEl.textContent = "Sauti Imepokelewa.";
                } else {
                     predictionResultEl.textContent = "Sikuelewi vizuri. Tafadhali jaribu tena au andika.";
                }
            };

            recognition.onspeechend = () => {
                micBtn.style.backgroundColor = '#2196F3'; 
                micBtn.textContent = 'ðŸŽ¤';
                recognition.stop();
            };

            recognition.onerror = (event) => {
                micBtn.style.backgroundColor = '#2196F3'; 
                micBtn.textContent = 'ðŸŽ¤';
                alert(`Kosa: ${event.error}. Hakikisha umetoa ruhusa ya mikrofoni.`);
            };
        } else {
            micBtn.style.display = 'none';
        }
        // --- MWISHO WA VOICE INPUT ---


        // --- LOGIC YA KUBONYEZA KITUFE KIMOJA ---
        mainButton.addEventListener('click', () => {
            const lastRound = parseFloat(roundInput.value);

            if (isNaN(lastRound) || lastRound <= 0.99) {
                predictionResultEl.textContent = "Weka namba sahihi (Multipler > 1.0)";
                return;
            }

            // 1. Fanya Utabiri
            const predicted = predictMultiplier(lastRound);
            const jackpot = checkJackpot();

            // 2. Igiza (Simulate) Matokeo Halisi ya Mzunguko Huo
            const simulatedActual = parseFloat(generateSimulatedActual(predicted));
            
            // 3. Fanya Logic ya Kujifunza (Compare Predicted vs Simulated Actual)
            attempts++;
            // Huhesabu kosa ikiwa tofauti kati ya utabiri na matokeo ya kuigiza ni kubwa
            if (Math.abs(parseFloat(predicted) - simulatedActual) > 2.5) { 
                mistakes++;
            }

            // 4. Hifadhi data
            localStorage.setItem('aviator_attempts', attempts);
            localStorage.setItem('aviator_mistakes', mistakes);

            // 5. Onyesha Matokeo & Rudisha Kwenye Mode Mpya
            updateLearningStatus();
            
            predictionResultEl.innerHTML = `
                PREDICTED: <span style="color:#ff9800;">${predicted}x</span><br>
                ACTUAL (Simulated): <span style="color:#00e676;">${simulatedActual.toFixed(2)}x</span>
            `;
            jackpotStatusEl.textContent = jackpot;
            
            // Weka Matokeo Halisi (Simulated) kama 'Last Round' kwa ajili ya mzunguko ujao
            roundInput.value = simulatedActual.toFixed(2); 
            alert(`Kujifunza Kumekamilika! Utabiri umefanywa, na mfumo umejifunza kwa kuigiza matokeo ${simulatedActual.toFixed(2)}x.`);
        });

        updateLearningStatus();
    </script>
</body>
</html>
